<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

    >webcomponents (v0.1.4)</a>
</h1>
<h4>Server side web components.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.webcomponents">module webcomponents</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index">
            function <span class="apidocSignatureSpan">webcomponents.</span>index
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">webcomponents.</span>_eventsCount</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">webcomponents.</span>_events</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">webcomponents.</span>domain</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">webcomponents.</span>index.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.webcomponents.index">module webcomponents.index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.index">
            function <span class="apidocSignatureSpan">webcomponents.</span>index
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.super_">
            function <span class="apidocSignatureSpan">webcomponents.index.</span>super_
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.webcomponents.index.prototype">module webcomponents.index.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.fetchContent">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchContent
            <span class="apidocSignatureSpan">($template)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.fetchResources">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchResources
            <span class="apidocSignatureSpan">($component)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.fetchStyle">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchStyle
            <span class="apidocSignatureSpan">($component)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.fetchTemplate">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchTemplate
            <span class="apidocSignatureSpan">($component)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.render">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>render
            <span class="apidocSignatureSpan">($customElement, globalData)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.renderElement">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderElement
            <span class="apidocSignatureSpan">(rendered)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.renderStyle">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderStyle
            <span class="apidocSignatureSpan">(style)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.renderTemplate">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderTemplate
            <span class="apidocSignatureSpan">(template, componentData, globalData, relativePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.webcomponents.index.prototype.renderTree">
            function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderTree
            <span class="apidocSignatureSpan">($fragment, globalData)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.webcomponents" id="apidoc.module.webcomponents">module webcomponents</a></h1>


    <h2>
        <a href="#apidoc.element.webcomponents.index" id="apidoc.element.webcomponents.index">
        function <span class="apidocSignatureSpan">webcomponents.</span>index
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Component(name) {
    Element.call(this, name);

    var definition = CustomElements.getRegisteredDefinition(name);

    this.path = definition.path;
    this.adapter = definition.adapter;
    this.attributes = definition.attributes;
    this.outer = definition.outer;
    this.$ = definition.$;
    this.$component = definition.$component;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.webcomponents.index" id="apidoc.module.webcomponents.index">module webcomponents.index</a></h1>


    <h2>
        <a href="#apidoc.element.webcomponents.index.index" id="apidoc.element.webcomponents.index.index">
        function <span class="apidocSignatureSpan">webcomponents.</span>index
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Component(name) {
    Element.call(this, name);

    var definition = CustomElements.getRegisteredDefinition(name);

    this.path = definition.path;
    this.adapter = definition.adapter;
    this.attributes = definition.attributes;
    this.outer = definition.outer;
    this.$ = definition.$;
    this.$component = definition.$component;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.super_" id="apidoc.element.webcomponents.index.super_">
        function <span class="apidocSignatureSpan">webcomponents.index.</span>super_
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Element(name){
    this.name = name;
    this.attributes = {};

    // invoke createdCallback
    if (this.createdCallback) {
        this.createdCallback();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.webcomponents.index.prototype" id="apidoc.module.webcomponents.index.prototype">module webcomponents.index.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.fetchContent" id="apidoc.element.webcomponents.index.prototype.fetchContent">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchContent
        <span class="apidocSignatureSpan">($template)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fetchContent = function ($template) {

    var self = this;
    var $ = self.$;
    var $customElement = self.$customElement;
    // render composed DOM
    $template.find(&#x27;content&#x27;).each(function () {
        var $content = $(this);
        var select = $content.attr(&#x27;select&#x27;);

        var $matched;
        if (select) {
            $matched = $customElement.find(select);
        } else {
            $matched = $customElement.children()
        }
        $content.replaceWith($matched);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Component.prototype.fetchTemplate = function ($component) {
    var $template = $component.find(&#x27;template&#x27;);

    if ($template.length) {

        var type = $template.attr(&#x27;type&#x27;) || &#x27;template&#x27;;
        this.<span class="apidocCodeKeywordSpan">fetchContent</span>($template);
        return {
            content: $template.html(),
            type: type
        };
    }

};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.fetchResources" id="apidoc.element.webcomponents.index.prototype.fetchResources">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchResources
        <span class="apidocSignatureSpan">($component)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fetchResources = function ($component) {
    var self = this;
    var $ = this.$;
    var requestPromises = [];

    CustomElements.getRegistered(RESOURCE_TYPE).forEach(function (customElement) {
        var $resources = $component.find(customElement);

        $resources.each(function () {

            var $resource = $(this);
            var tagName = this.name;
            var resourceElement = CustomElements.create(tagName);

            CustomElements.getPublishedAttributes(tagName).forEach(function (attribute) {
                var value = $resource.attr(attribute);
                if (value) resourceElement.setAttribute(attribute, value);
            });
            // Before request handler
            resourceElement.beforeRequest &#x26;&#x26; resourceElement.beforeRequest(self.attributes);

            var promise = new Promise(function (resolve, reject) {
                resourceElement.request(resolve, reject);
            });

            requestPromises.push(promise);
        });

        // remove it
        $resources.remove();
    });

    return Promise.all(requestPromises)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Component.prototype.render = function ($customElement, globalData) {
var self = this;
self.$customElement = $customElement;
var $component = self.$component;

// process template
var promise = self.<span class="apidocCodeKeywordSpan">fetchResources</span>($component)
    .then(function (componentData) {
        // componentData is array
        var rendered = &#x27;&#x27;;
        var template = self.fetchTemplate($component);
        if (template) {
            rendered = self.renderTemplate(template, componentData, globalData, self.path);
        }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.fetchStyle" id="apidoc.element.webcomponents.index.prototype.fetchStyle">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchStyle
        <span class="apidocSignatureSpan">($component)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fetchStyle = function ($component) {
    var $style = $component.find(&#x27;style&#x27;);
    var type = $style.attr(&#x27;type&#x27;) || &#x27;style&#x27;;
    if ($style.length) {
        return {
            content: Style.shimShadowStyles($style.html(), this.name),
            type: type
        };
    }
    // TODO: support external link
    // var $link = $component.find(&#x27;link[ref=stylesheet]&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    rendered = self.renderTemplate(template, componentData, globalData, self.path);
}
return rendered;

        })
        .then(function (rendered) {
// process style
var style = self.<span class="apidocCodeKeywordSpan">fetchStyle</span>($component);
var styleHtml = self.renderStyle(style);
return styleHtml + rendered;
        })
        .then(function (rendered) {
self.renderElement(rendered);

// Must render current component first that may pass dynamic params to sub component attributes.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.fetchTemplate" id="apidoc.element.webcomponents.index.prototype.fetchTemplate">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>fetchTemplate
        <span class="apidocSignatureSpan">($component)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fetchTemplate = function ($component) {
    var $template = $component.find(&#x27;template&#x27;);

    if ($template.length) {

        var type = $template.attr(&#x27;type&#x27;) || &#x27;template&#x27;;
        this.fetchContent($template);
        return {
            content: $template.html(),
            type: type
        };
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var $component = self.$component;

    // process template
    var promise = self.fetchResources($component)
.then(function (componentData) {
    // componentData is array
    var rendered = &#x27;&#x27;;
    var template = self.<span class="apidocCodeKeywordSpan">fetchTemplate</span>($component);
    if (template) {
        rendered = self.renderTemplate(template, componentData, globalData, self.path);
    }
    return rendered;

})
.then(function (rendered) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.render" id="apidoc.element.webcomponents.index.prototype.render">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>render
        <span class="apidocSignatureSpan">($customElement, globalData)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">render = function ($customElement, globalData) {
    var self = this;
    self.$customElement = $customElement;
    var $component = self.$component;

    // process template
    var promise = self.fetchResources($component)
        .then(function (componentData) {
            // componentData is array
            var rendered = &#x27;&#x27;;
            var template = self.fetchTemplate($component);
            if (template) {
                rendered = self.renderTemplate(template, componentData, globalData, self.path);
            }
            return rendered;

        })
        .then(function (rendered) {
            // process style
            var style = self.fetchStyle($component);
            var styleHtml = self.renderStyle(style);
            return styleHtml + rendered;
        })
        .then(function (rendered) {
            self.renderElement(rendered);

            // Must render current component first that may pass dynamic params to sub component attributes.
            // TODO: how to optimize in production env when sub component is rendered by dynamic dependent
            self.renderTree($customElement, globalData);
        });

    return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
&#x3c;/x-hello&#x3e;
```

```js
var WebComponents = require(&#x27;webcomponents&#x27;);

WebComponents.load(&#x27;/components/**/*.html&#x27;);
WebComponents.<span class="apidocCodeKeywordSpan">render</span>(&#x27;index.html&#x27;, {project: &#x27;WebComponents&#x27;}).then
(
    function(rendered){
        fs.writeFileSync(&#x27;index_rendered.html&#x27;, rendered)
    }
);

```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.renderElement" id="apidoc.element.webcomponents.index.prototype.renderElement">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderElement
        <span class="apidocSignatureSpan">(rendered)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">renderElement = function (rendered) {
    var self = this;
    var $customElement = self.$customElement;

    if (self.outer) {
        $customElement.replaceWith(rendered);
    } else {
        // Convert custom tag to shim tag with component class
        if($customElement[0].name == self.name){
            $customElement[0].name = SHIM_TAG_NAME;
            $customElement.addClass(self.name);
        }

        $customElement.html(rendered);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    .then(function (rendered) {
        // process style
        var style = self.fetchStyle($component);
        var styleHtml = self.renderStyle(style);
        return styleHtml + rendered;
    })
    .then(function (rendered) {
        self.<span class="apidocCodeKeywordSpan">renderElement</span>(rendered);

        // Must render current component first that may pass dynamic params to sub component attributes.
        // TODO: how to optimize in production env when sub component is rendered by dynamic dependent
        self.renderTree($customElement, globalData);
    });

return promise;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.renderStyle" id="apidoc.element.webcomponents.index.prototype.renderStyle">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderStyle
        <span class="apidocSignatureSpan">(style)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">renderStyle = function (style) {
    if (!style) {
        return &#x27;&#x27;;
    }

    var self = this;
    var content = style.content;
    var type = style.type;

    return [&#x27;&#x3c;style&#x3e;&#x27;, content, &#x27;&#x3c;/style&#x3e;&#x27;].join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
return rendered;

        })
        .then(function (rendered) {
// process style
var style = self.fetchStyle($component);
var styleHtml = self.<span class="apidocCodeKeywordSpan">renderStyle</span>(style);
return styleHtml + rendered;
        })
        .then(function (rendered) {
self.renderElement(rendered);

// Must render current component first that may pass dynamic params to sub component attributes.
// TODO: how to optimize in production env when sub component is rendered by dynamic dependent
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.renderTemplate" id="apidoc.element.webcomponents.index.prototype.renderTemplate">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderTemplate
        <span class="apidocSignatureSpan">(template, componentData, globalData, relativePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">renderTemplate = function (template, componentData, globalData, relativePath) {
    var self = this;
    var content = template.content;
    var type = template.type;
    var engine = Engine.get(type);

    var combinedData = componentData;

    if (_.isArray(componentData)) {
        // TODO: the performance of &#x27;call&#x27; is better then &#x27;apply&#x27;
        combinedData = _.extend.apply(null, _.clone(componentData));
    }

    var data = _.extend({}, globalData, self.attributes, combinedData);
    if (_.isFunction(self.adapter)) {
        var fn = self.adapter;
        var context = {
            request: globalData.request,
            req: globalData.request,
            response: globalData.response,
            res: globalData.response,
            global: globalData,
            attributes: self.attributes,
            // resource data
            data: componentData
        };
        // TODO: clone data if pass data may be rewrite, but it performance mate
        data = fn.call(context, data);
    }

    if (engine.compile &#x26;&#x26; engine.render) {
        var compiled = engine.compile(content, relativePath);
        return engine.render(compiled, data);
    } else if (_.isFunction(engine)) {
        return engine(content, data, relativePath);
    } else {
        console.error(&#x27;Engine&#x27;, type, &#x27;unregistered&#x27;);
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // process template
    var promise = self.fetchResources($component)
.then(function (componentData) {
    // componentData is array
    var rendered = &#x27;&#x27;;
    var template = self.fetchTemplate($component);
    if (template) {
        rendered = self.<span class="apidocCodeKeywordSpan">renderTemplate</span>(template, componentData, globalData, self.path
);
    }
    return rendered;

})
.then(function (rendered) {
    // process style
    var style = self.fetchStyle($component);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.webcomponents.index.prototype.renderTree" id="apidoc.element.webcomponents.index.prototype.renderTree">
        function <span class="apidocSignatureSpan">webcomponents.index.prototype.</span>renderTree
        <span class="apidocSignatureSpan">($fragment, globalData)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">renderTree = function ($fragment, globalData) {
    var self = this;
    var $ = self.$;

    var customElementPromises = [];

    CustomElements.getRegistered().forEach(function (customElement) {

        function renderElement(index, elem) {
            var $customElement = $(this);
            var component = new Component(customElement);

            CustomElements.getPublishedAttributes(customElement).forEach(function (attribute) {
                var value = $customElement.attr(attribute);
                if (value) component.setAttribute(attribute, value);
            });

            var renderPromise = component.render($customElement, globalData);
            // render all multi-level nested component
            var renderTreePromise = self.renderTree($customElement, globalData);

            customElementPromises.push(renderPromise, renderTreePromise);
        }

        $fragment.find(customElement).each(renderElement);
        $fragment.find(&#x27;[is=&#x27; + customElement + &#x27;]&#x27;).each(renderElement);
    });

    return Promise.all(customElementPromises);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        return styleHtml + rendered;
    })
    .then(function (rendered) {
        self.renderElement(rendered);

        // Must render current component first that may pass dynamic params to sub component attributes.
        // TODO: how to optimize in production env when sub component is rendered by dynamic dependent
        self.<span class="apidocCodeKeywordSpan">renderTree</span>($customElement, globalData);
    });

return promise;
};

Component.prototype.renderElement = function (rendered) {
var self = this;
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
